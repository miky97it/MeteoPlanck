5 TIM E
10 MEM 500,H9
20  B$(1)=" TEMP.EXT  "
30  B$(2)=" UMIDITA'  "
40  B$(3)=" PRESSIONE "
50  B$(4)=" RADIAZIONE"
60  B$(5)=" DIR VENTO "
70  B$(6)=" VEL VENTO "
80  B$(7)=" PRECIPIT. "
90 TIM E
100  H=H9+(M9/100)
110 OPEN #3,4,10,23,4
120 PRINT #3,"H,2"
130 PRINT #3,H;G9;M8;Y9;
140 PRINT #3," S "
150 PRINT
160 PRINT " METEO          N.MIS.  MEDIA      MIN.     MAX."
170 PRINT
180 FOR I=1 TO 7
190   FOR K=1 TO 5
200      J=(I-1)*5
210      RCL J+K,Z(K)
220   NEXT K
230   IF Z(1)>0 GOTO 260
240    M1=9999
250   GOTO 290
260   IF I=5 GOTO 420
270   IF I=7 GOTO 370
280    M1=Z(2)/Z(1)
290    N0=INT(Z(1))
300    M1=(INT(M1*100))/100
310    M2=(INT(Z(3)*100))/100
320    M3=(INT(Z(4)*100))/100
330   PRINT B$(I);TAB(16);N0;TAB(24);M1;TAB(36);M2;TAB(46);M3
340   PRINT #3,M1,M2,M3
350 NEXT I
360 GOTO 760
370  M1=Z(2)
380  N0=Z(1)
390  M2=0
400  M3=M1
410 GOTO 330
420  A=A
430  N0=Z(1)
440  M1=Z(1)
450  M3=Z(3)
460  M4=Z(4)
470 IF M1=0 GOTO 500
480  Y1=(M3*M3+M4*M4)/(M1*M1)
490 IF Y1<=1 GOTO 520
500  M1=9999
510 GOTO 750
520  Y2=SQR(1-Y1)
530  Y8=1-Y2*Y2
540 IF Y8<=0 GOTO 600
550  Y3=Y2/SQR(1-Y2*Y2)
560  M2=ATAN(Y3)
570  M2=INT(M2*100)
580  M2=M2/100
590 IF M4<>0 GOTO 620
600  A1=99999999#
610 GOTO 630
620  A1=ABS(M3/M4)
630  A2=57.324*ATAN(A1)
640 IF M3<0 GOTO 690
650 IF M4<0 GOTO 670
660 GOTO 730
670  A2=180-A2
680 GOTO 730
690 IF M4<0 GOTO 720
700  A2=360-A2
710 GOTO 730
720  A2=A2+180
730  M1=INT(A2)
740  M3=Z(5)
750 GOTO 330
760  A=A
770 FOR I=1 TO 7
780    J2=(I-1)*5
790   MEM J2+1,0
800   MEM J2+2,0
810   MEM J2+3,5000
820   MEM J2+4,-5000
830   MEM J2+5,0
840 NEXT I
850 MEM 23,0
860 MEM 24,0
870 PRINT 
880 IF H9<>0 THEN 930
890 FOR I=8 TO 13
900    RCL I+28,P
910    PRINT #3,P
920 NEXT I
930 PRINT #3,"*"
940 CLOSE #3
950 DELETE 20
960 INSERT 40
970 PAC
